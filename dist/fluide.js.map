{"version":3,"file":"fluide.js","sources":["../js/scrollbar/events.ts","../js/scrollbar/main.ts","../js/main.ts"],"sourcesContent":["import Scrollbar from \"./main\"\n\nexport default class Events {\n  private scrollbar: Scrollbar\n  private currentY: number\n  private distance: number\n\n  private isMac: RegExpMatchArray = navigator.platform.match(\n    /(Mac|iPhone|iPod|iPad)/i\n  )\n\n  private isScroling: boolean = false\n  private isWheeling: number = null\n\n  // TODO: react on scroll changed by user (element.scrollTop = (...)), by binding event listener\n\n  constructor(scrollbar: Scrollbar) {\n    this.scrollbar = scrollbar\n\n    this.scrollbar.el.onwheel = event => this.mouseWheel(event)\n    this.scrollbar.scroll.onwheel = event => this.mouseWheel(event)\n    this.scrollbar.bar.onmousedown = event => this.mouseDown(event)\n    document.onmouseup = event => this.mouseUp(event)\n\n    this.scrollbar.el.onscroll = event => this.userScrolled(event)\n  }\n\n  mouseDown(this: Events, event: MouseEvent) {\n    this.isScroling = true\n    this.distance = 0\n    this.currentY = event.pageY\n    document.onmousemove = event => this.mouseMove(event)\n  }\n\n  mouseMove(this: Events, event: MouseEvent) {\n    event.preventDefault()\n\n    let distance = event.pageY - this.currentY\n    this.currentY = event.pageY\n\n    if (distance != this.distance) {\n      this.distance = distance\n      this.scrollbar.move(this.distance)\n    }\n  }\n\n  mouseWheel(this: Events, event: WheelEvent) {\n    event.preventDefault()\n    this.isScroling = true;\n\n    let distance = null\n    if (this.isMac) {\n      distance = event.deltaY * 0.05\n    } else {\n      distance = event.deltaY\n    }\n\n    if (distance != this.distance) {\n      this.distance = distance\n      this.scrollbar.move(this.distance)\n    }\n\n    clearTimeout(this.isWheeling)\n    this.isWheeling = setTimeout(() => {\n      this.isScroling = false;\n    }, 250)\n  }\n\n  mouseUp(this: Events, event: MouseEvent) {\n    document.onmousemove = null\n    this.distance = 0\n\n    this.isScroling = false\n  }\n\n  userScrolled(this: Events, event: UIEvent) {\n    if(!this.isScroling) {\n      let position = this.scrollbar.el.scrollTop\n      this.scrollbar.setBarPosition(position)\n    }\n  }\n}\n","import Events from './events'\n\nexport default class Scrollbar {\n\n  private events: Events\n\n  public el: HTMLElement\n\n  public scroll: HTMLElement\n  public bar: HTMLElement\n\n  private height: number\n  private scrollHeight: number\n  private barProportion: number\n  private barHeight: number\n\n  private position: number = 0\n  private maxPosition: number = 0\n\n  private scrollClass: number = null\n\n  constructor(el: HTMLElement) {\n    this.el = el\n\n    this.el.classList.add('scroll-content')\n\n    this.el.style.overflow = 'auto'\n    this.height = this.el.clientHeight\n    this.scrollHeight = this.el.scrollHeight\n    this.el.style.overflow = 'hidden'\n\n    this.createScroll()\n    this.calculateSizes()\n  }\n\n  calculateSizes() {\n    this.barProportion = parseFloat((this.height / this.scrollHeight).toPrecision(1))\n    \n    if (this.height * this.barProportion > 26) {\n      this.barHeight = this.height * this.barProportion\n    } else {\n      // this.barHeight = this.height * this.barProportion\n      this.barHeight = 26\n    }\n\n    this.maxPosition = this.height - this.barHeight\n\n    this.scroll.style.height = this.height + 'px'\n    this.bar.style.height = this.barHeight + 'px'\n\n    this.el.style.width = (this.el.offsetWidth - this.scroll.offsetWidth) + \"px\"\n  }\n\n  createScroll() {\n    this.scroll = document.createElement('div')\n    this.scroll.classList.add('scroll-bar')\n\n    this.bar = document.createElement('div')\n    this.bar.classList.add('bar')\n\n    this.scroll.appendChild(this.bar)\n\n    this.events = new Events(this)\n\n    this.el.parentElement.insertBefore(this.scroll, this.el.nextSibling)\n  }\n\n  move(distance: number) {\n    let newPosition = (distance + this.position)\n\n    if (newPosition <= 0) {\n      this.position = 0\n    } else if (newPosition < this.maxPosition) {\n      this.position = newPosition\n    } else {\n      this.position = this.maxPosition\n    }\n\n    this.el.scrollTop = (this.position / this.maxPosition) * (this.scrollHeight - this.height)\n    this.bar.style.marginTop = this.position + 'px'\n\n    this.scroll.className = this.scroll.className.indexOf('scroll-active') > 0 ? this.scroll.className : this.scroll.className + ' scroll-active'\n    clearTimeout(this.scrollClass)\n    this.scrollClass = setTimeout(() => {\n      this.scroll.className = this.scroll.className.replace(/\\s*scroll-active\\s*/g, '')\n    }, 500)\n  }\n\n  setBarPosition(scrollPosition: number) {\n    let position = scrollPosition * this.barProportion\n\n    if (position <= 0) {\n      this.position = 0;\n    } else if (position < this.maxPosition) {\n      this.position = position;\n    } else {\n      this.position = this.maxPosition;\n    }\n\n    this.bar.style.marginTop = this.position + \"px\";\n  }\n\n}","import Scrollbar from './scrollbar/main'\n\nexport default {\n  version: '__VERSION__',\n  Scrollbar: Scrollbar\n}"],"names":[],"mappings":"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"}